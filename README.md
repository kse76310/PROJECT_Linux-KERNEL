
### 1. 개요

-   임베디드 리눅스 시스템의 핵심인 디바이스 드라이버에 대한 심층적인 이해를 목표로, I2C 통신 기반의 센서(BMP180)와 LCD를 위한 드라이버를 직접 개발함.
-   개발한 시스템은 센서 노드(서버)가 온도/기압 데이터를 수집하여 TCP/IP 소켓 통신으로 전송하면, 디스플레이 노드(클라이언트)가 데이터를 수신하여 자체 개발한 LCD 드라이버로 화면에 출력하는 구조로 설계함.

### 2. 시스템 구성

<img width="523" height="283" alt="KakaoTalk_20250709_163457679" src="https://github.com/user-attachments/assets/1a966977-d4ab-4aa4-a602-c9cb78e897b7" />

<img width="726" height="711" alt="스크린샷 2025-07-09 101224" src="https://github.com/user-attachments/assets/71c15008-6400-4538-8d36-cb40bde808a2" />

### 3. 주요 기능

#### 1) BMP180 I2C 디바이스 드라이버 개발
- 데이터시트를 분석하여 센서 EEPROM의 보정값을 로드하고, 이를 활용해 온도와 기압을 계산하는 변환 공식을 C언어로 구현함.

#### 2) 멀티스레드 기반 TCP/IP 서버 및 클라이언트 구현
-   **서버 (센서 노드)**
    -   메인 스레드는 `listen()`을 통해 클라이언트의 연결을 대기함.
    -   `accept()` 함수로 연결이 수락되면, 해당 클라이언트와의 통신을 전담하는 새로운 작업 스레드를 생성함.
    -   작업 스레드는 주기적으로 BMP180 드라이버로부터 센서 데이터를 읽어와 연결된 클라이언트에게 전송함으로써, 여러 클라이언트의 동시 요청을 처리할 수 있는 확장성 있는 구조를 갖춤.

-   **클라이언트 (디스플레이 노드)**
    -   서버로부터 수신한 온도/기압 데이터 문자열을 `sscanf` 함수로 파싱하여 온도와 기압 값을 분리함.
    -   사전에 정의된 LCD 드라이버 프로토콜에 맞게 데이터를 가공한 후 I2C LCD 화면에 출력함.

### 4. 결론 및 개선점

#### **[ 결론 ]**

1.  **메모리 관리 능력 향상**
    -   코드 리뷰 과정에서 서버의 작업 스레드 생성 시 `malloc`으로 할당된 클라이언트 정보 구조체가 스레드 종료 시점에 해제되지 않는 메모리 누수 오류를 발견함.
    -   스레드 종료 로직에 `free` 호출을 명시적으로 추가하여 시스템 안정성을 확보하는 방안을 학습함.

2.  **커널 동기화 메커니니즘의 이해**
    -   단일 프로세스만 드라이버를 사용하는 환경이었으나, 다중 프로세스가 드라이버에 동시 접근할 경우 발생 가능한 경쟁 상태(Race Condition)를 인지함.
    -   `mutex`나 `semaphore`를 활용하여 드라이버의 임계 영역(Critical Section)을 보호함으로써, 더욱 견고하고 안정적인 디바이스 드라이버를 설계하는 방안에 대해 심도 있게 학습함.

#### **[ 개선점 ]**

-   현재의 스레드 기반 서버 모델을 `select()`나 `epoll()`과 같은 I/O 멀티플렉싱 방식으로 개선하여, 더 적은 자원으로 더 많은 클라이언트를 효율적으로 관리하는 고성능 서버로 발전시키고 싶음.
